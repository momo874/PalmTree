<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Free AI Chat</title>

<script src="https://js.puter.com/v2/"></script>

<style>
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: #0f0f0f;
  color: white;
  display: flex;
  justify-content: center;
  height: 100vh;
}

.chat {
  width: 100%;
  max-width: 800px;
  display: flex;
  flex-direction: column;
}

.messages {
  flex: 1;
  padding: 20px;
  overflow-y: auto;
}

.msg {
  margin-bottom: 15px;
  padding: 12px 14px;
  border-radius: 10px;
  max-width: 80%;
  white-space: pre-wrap;
}

.user {
  background: #10a37f;
  align-self: flex-end;
}

.ai {
  background: #1e1e1e;
  align-self: flex-start;
}

.input {
  display: flex;
  padding: 15px;
  background: #1a1a1a;
  gap: 10px;
}

input {
  flex: 1;
  padding: 12px;
  border-radius: 10px;
  border: none;
  outline: none;
  font-size: 16px;
}

button {
  width: 46px;
  height: 46px;
  border-radius: 50%;
  border: none;
  background: white;
  color: black;
  font-size: 18px;
  cursor: pointer;
}
</style>
</head>

<body>
<div class="chat">
  <div class="messages" id="messages"></div>

  <div class="input">
    <input id="input" placeholder="Send a message..." />
    <button id="sendBtn">âž¤</button>
  </div>
</div>

<script>
const messages = document.getElementById("messages");
const input = document.getElementById("input");
const sendBtn = document.getElementById("sendBtn");

// load saved chat
messages.innerHTML = localStorage.getItem("chat") || "";

function saveChat() {
  localStorage.setItem("chat", messages.innerHTML);
}

async function sendMessage() {
  const text = input.value.trim();
  if (!text) return;

  const userMsg = document.createElement("div");
  userMsg.className = "msg user";
  userMsg.textContent = text;
  messages.appendChild(userMsg);

  const aiMsg = document.createElement("div");
  aiMsg.className = "msg ai";
  messages.appendChild(aiMsg);

  messages.scrollTop = messages.scrollHeight;
  input.value = "";

  const stream = await puter.ai.chat({
    prompt: text,
    stream: true
  });

  for await (const part of stream) {
    aiMsg.textContent += part.text;
    messages.scrollTop = messages.scrollHeight;
    saveChat();
  }
}

// click send
sendBtn.addEventListener("click", sendMessage);

// ENTER key fix (NO redirect)
input.addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    e.preventDefault(); // ðŸ”¥ stops puter redirect
    sendMessage();
  }
});
</script>
</body>
</html>
